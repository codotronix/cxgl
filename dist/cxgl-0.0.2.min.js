/*
 *  CXGL: Codotronix Game Library
 *  Version: 0.0.2
 *  Author: Suman Barick
 */
window.cxgl={},function(i){window.cxgl.Utils={generateID:function(i){var t;i=i||"gobj";for(;void 0===t||0<=o.indexOf(t);)t=i+"-"+(Math.random()*parseInt(Math.random().toString().replace(/[.]/g,""))).toString().replace(/[.]/g,"-");return o.push(t),t},deleteID:function(i){o.splice(o.indexOf(i),1)}};var o=[]}(),function(n){var t=!(n.cxgl.Ticker={onTick:function(i,t,o){var e=cxgl.Utils.generateID("ticker");return r.push({id:e,fn:i,obj:t||n,skipTick:void 0===o||o<0?1:o}),s(),e},startTick:s,stopTick:function(){t=!1},removeTick:function(i){for(var t=!1,o=0;o<r.length;o++)if(r[o].id===i){r.splice(o,1),t=!0;break}return t}}),r=[],o=0,e=27e6;function s(){t||(t=!0,h())}function h(){if(t){for(var i in o++,r)o%r[i].skipTick==0&&r[i].fn.apply(r[i].obj);o===e&&(o=0),setTimeout(h,1e3/60)}}}(window),function(i){window.cxgl.KeyEvent={onKeyPress:function(i,t,o){null==e[i]&&(e[i]=[]);e[i].push({fn:t,obj:o})},keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32}};var e={};$(document).on("keydown",function(i){for(var t in e)if(i.keyCode==t)for(var o in e[t])e[t][o].fn.apply(e[t][o].obj)})}(),function(i){window.cxgl.Collision={watch:function(i,t){n.push({group1:$.isArray(i)?i:[i],group2:$.isArray(t)?t:[t]})},isColliding:s,isCollidingGroup:function(i,t){var o=$.isArray(i)?i:[i],e=$.isArray(t)?t:[t];for(var n in o)for(var r in e)if(s(o[n],e[r]))return!0;return!1}};var n=[];function t(){var i;for(var t in n)for(var o in(i=n[t]).group1)for(var e in i.group2)s(i.group1[o],i.group2[e])&&(void 0!==i.group1[o].onCollision&&i.group1[o].onCollision(i.group2[e]),void 0!==i.group2[e].onCollision&&i.group2[e].onCollision(i.group1[o]))}function s(i,t){return!(i._objID===t._objID||i.x+i.width<t.x||i.x>t.x+t.width||i.y+i.height<t.y||i.y>t.y+t.height)}cxgl.Ticker.onTick(t)}(),function(i){window.cxgl.GameObject={create:function(i){var t=new e(i);n.push(t),"ground"===t.type&&o.push(t);return t},getAll:function(i){{if(void 0===i)return n;for(var t=[],o=0;o<n.length;o++)for(var e in i)n[o][e]===i[e]&&t.push(n[o]);return t}}};var n=[],o=[];function e(i){for(var t in i)this[t]=i[t];this._objID=cxgl.Utils.generateID("gobj"),this.x=this.x||0,this.y=this.y||0,this.speed=this.speed||1,this.speedX=this.speedX||this.speed,this.speedY=this.speedY||this.speed,this.holdDirectionNTurns=this.holdDirectionNTurns||9,this.gravityOn=this.gravityOn||!1,this.weight=this.weight||1,this.gravityIndex=this.gravityIndex||.5,this._speedDueToGravity=0,this.render()}function t(){for(var i=0;i<n.length;i++)n[i].gravityOn&&(n[i]._speedDueToGravity+=n[i].gravityIndex,n[i].y+=n[i]._speedDueToGravity,cxgl.Collision.isCollidingGroup(n[i],o)&&(n[i].y-=n[i]._speedDueToGravity,n[i]._speedDueToGravity=0),n[i].render())}e.prototype.render=function(){$("#"+this.htmlId).css({top:this.y+"px",left:this.x+"px"})},e.prototype.moveLeft=function(){this.x-=this.speedX||this.speed,this.direction="W",this.render()},e.prototype.moveRight=function(){this.x+=this.speedX||this.speed,this.direction="E",this.render()},e.prototype.moveUp=function(){this.direction="N",this.y-=this.speedY||this.speed,this.render()},e.prototype.moveDown=function(){this.direction="S",this.y+=this.speedY||this.speed,this.render()},e.prototype.move=function(i){"LEFT"===i||"W"===i?this.moveLeft():"RIGHT"===i||"E"===i?this.moveRight():"UP"===i||"N"===i?this.moveUp():"DOWN"===i||"S"===i?this.moveDown():"RANDOM-4"!==i&&void 0!==i||((!this._holdDirectionCounter||this._holdDirectionCounter>this.holdDirectionNTurns)&&("N"===this.prevDirection?this.direction=["N","E","W"][Math.floor(3*Math.random())]:"E"===this.prevDirection?this.direction=["N","E","S"][Math.floor(3*Math.random())]:"S"===this.prevDirection?this.direction=["E","S","W"][Math.floor(3*Math.random())]:"W"===this.prevDirection?this.direction=["N","S","W"][Math.floor(3*Math.random())]:this.direction=["E","W","N","S"][Math.floor(4*Math.random())],this.prevDirection=this.direction,this._holdDirectionCounter=0),this._holdDirectionCounter++,this.move(this.direction))},e.prototype.startContinuousMove=function(i,t){this.continuousMoveCBRef||(this.continuousMoveCBRef=cxgl.Ticker.onTick(function(){t?o.move():o.move(o.direction)},void 0,i));var o=this},e.prototype.stopContinuousMove=function(){cxgl.Ticker.removeTick(this.continuousMoveCBRef),this.continuousMoveCBRef=void 0},e.prototype.turnAround=function(){this.direction={E:"W",W:"E",N:"S",S:"N"}[this.direction],this.move(this.direction)},e.prototype.onCollision=function(i){},cxgl.Ticker.onTick(t)}();