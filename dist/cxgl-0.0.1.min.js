/*
 *  CXGL: Codotronix Game Library
 *  Version: 0.0.1
 *  Author: Suman Barick
 */
window.cxgl={},function(i){window.cxgl.Utils={generateID:function(i){var t;i=i||"gobj";for(;void 0===t||0<=o.indexOf(t);)t=i+"-"+(Math.random()*parseInt(Math.random().toString().replace(/[.]/g,""))).toString().replace(/[.]/g,"-");return o.push(t),t},deleteID:function(i){o.splice(o.indexOf(i),1)}};var o=[]}(),function(e){var t=!(e.cxgl.Ticker={onTick:function(i,t,o){var n=cxgl.Utils.generateID("ticker");return r.push({id:n,fn:i,obj:t||e,skipTick:void 0===o||o<0?1:o}),s(),n},startTick:s,stopTick:function(){t=!1},removeTick:function(i){for(var t=!1,o=0;o<r.length;o++)if(r[o].id===i){r.splice(o,1),t=!0;break}return t}}),r=[],o=0,n=27e6;function s(){t||(t=!0,h())}function h(){if(t){for(var i in o++,r)o%r[i].skipTick==0&&r[i].fn.apply(r[i].obj);o===n&&(o=0),setTimeout(h,1e3/60)}}}(window),function(i){window.cxgl.KeyEvent={onKeyPress:function(i,t,o){null==n[i]&&(n[i]=[]);n[i].push({fn:t,obj:o})},keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32}};var n={};$(document).on("keydown",function(i){for(var t in n)if(i.keyCode==t)for(var o in n[t])n[t][o].fn.apply(n[t][o].obj)})}(),function(i){window.cxgl.Collision={watch:function(i,t){e.push({group1:$.isArray(i)?i:[i],group2:$.isArray(t)?t:[t]})},isColliding:s,isCollidingGroup:function(i,t){var o=$.isArray(i)?i:[i],n=$.isArray(t)?t:[t];for(var e in o)for(var r in n)if(s(o[e],n[r]))return!0;return!1}};var e=[];function t(){var i;for(var t in e)for(var o in(i=e[t]).group1)for(var n in i.group2)s(i.group1[o],i.group2[n])&&(void 0!==i.group1[o].onCollision&&i.group1[o].onCollision(i.group2[n]),void 0!==i.group2[n].onCollision&&i.group2[n].onCollision(i.group1[o]))}function s(i,t){return!(i._objID===t._objID||i.x+i.width<t.x||i.x>t.x+t.width||i.y+i.height<t.y||i.y>t.y+t.height)}cxgl.Ticker.onTick(t)}(),function(i){window.cxgl.GameObject={create:function(i){var t=new n(i);e.push(t),"ground"===t.type&&o.push(t);return t},getAll:function(i){{if(void 0===i)return e;for(var t=[],o=0;o<e.length;o++)for(var n in i)e[o][n]===i[n]&&t.push(e[o]);return t}}};var e=[],o=[];function n(i){for(var t in i)this[t]=i[t];this._objID=cxgl.Utils.generateID("gobj"),this.x=this.x||0,this.y=this.y||0,this.speed=this.speed||1,this.speedX=this.speedX||this.speed,this.speedY=this.speedY||this.speed,this.holdDirectionNTurns=this.holdDirectionNTurns||9,this.gravityOn=this.gravityOn||!1,this.weight=this.weight||1,this.render()}function t(){for(var i=0;i<e.length;i++)e[i].gravityOn&&(e[i].y+=.5,cxgl.Collision.isCollidingGroup(e[i],o)&&(e[i].y-=.5),e[i].render())}n.prototype.render=function(){$("#"+this.htmlId).css({top:this.y+"px",left:this.x+"px"})},n.prototype.moveLeft=function(){this.x-=this.speedX||this.speed,this.direction="W",this.render()},n.prototype.moveRight=function(){this.x+=this.speedX||this.speed,this.direction="E",this.render()},n.prototype.moveUp=function(){this.direction="N",this.y-=this.speedY||this.speed,this.render()},n.prototype.moveDown=function(){this.direction="S",this.y+=this.speedY||this.speed,this.render()},n.prototype.move=function(i){"LEFT"===i||"W"===i?this.moveLeft():"RIGHT"===i||"E"===i?this.moveRight():"UP"===i||"N"===i?this.moveUp():"DOWN"===i||"S"===i?this.moveDown():"RANDOM-4"!==i&&void 0!==i||((!this._holdDirectionCounter||this._holdDirectionCounter>this.holdDirectionNTurns)&&("N"===this.prevDirection?this.direction=["N","E","W"][Math.floor(3*Math.random())]:"E"===this.prevDirection?this.direction=["N","E","S"][Math.floor(3*Math.random())]:"S"===this.prevDirection?this.direction=["E","S","W"][Math.floor(3*Math.random())]:"W"===this.prevDirection?this.direction=["N","S","W"][Math.floor(3*Math.random())]:this.direction=["E","W","N","S"][Math.floor(4*Math.random())],this.prevDirection=this.direction,this._holdDirectionCounter=0),this._holdDirectionCounter++,this.move(this.direction))},n.prototype.startContinuousMove=function(i,t){this.continuousMoveCBRef||(this.continuousMoveCBRef=cxgl.Ticker.onTick(function(){t?o.move():o.move(o.direction)},void 0,i));var o=this},n.prototype.stopContinuousMove=function(){cxgl.Ticker.removeTick(this.continuousMoveCBRef),this.continuousMoveCBRef=void 0},n.prototype.turnAround=function(){this.direction={E:"W",W:"E",N:"S",S:"N"}[this.direction],this.move(this.direction)},n.prototype.onCollision=function(i){},cxgl.Ticker.onTick(t)}();